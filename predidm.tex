

\chapter{Mikroskopické modely}
\label{chap:predIDM}

\begin{comment}
Jednoduše øeèeno „Car Following“ modely vycházejí z~pøedpokladu, kdy $n$-té vozidlo následuje ($n-1$)-té vozidlo na homogenní (stejnorodé) dálnici, trajektorie n-tého vozidla bude v~podstatì stejná jako ($n-1$) vozidla kromì posunù v~èase a místì. (Vozidlo bude ve stejném místì jako pøedcházející v~jinı èas a ve stejnı èas bude na jiném místì). Všechna ostatní vymyšlená pravidla (modely) v~sobì toto jednoduché a pomìrnì pøesné pravidlo obsahují. Newellùv model je v~podstatì speciálním pøípadem ostatních modelù s~ménì parametry a jinou logikou. Poslouil také jako základ pro pozdìjší Intelligent Driver Model.
\end{comment}

Hlavní skupinou mikroskopickıch modelù jsou modely sledu vozidel (z~angl. \textit{car-following models}). Tyto modely vycházejí z~pøedpokladu, e pokud n-té vozidlo následuje $n-1$ vozidlo na homogenní komunikaci, trajektorie $n$-tého vozidla bude stejná, jako je trajektorie vozidla pøed ním (tedy vozidla $n-1$), a na posuny v~èase a místì (vozidlo bude ve stejném místì jako pøedcházející v~jinı èas a ve stejnı èas bude na jiném místì). Všechny další dispozice jednotlivıch modelù v~sobì tento pøedpoklad obsahují.

Na konci kadého modelu budou pro pøehlednost shrnuty parametry modelu a koneèná rovnice, podle které se vypoèítá budoucí hodnota rychlosti.

\section{Newellùv model}
\label{sec:Newell}

V~teorii dopravního proudu je Newellùv model jeden ze základních modelù popisujících chování vozidla na základì vozidla pøed ním. Øidiè se snaí dret za vozidlem jedoucím pøed ním v~konstantní  vzdálenosti. Tento model vznikl ji v~roce 1961. Zde jej zmiòujeme hlavnì z~dùvodu, e z~Newellovıch úvah vychází mnohé novìjší modely, napøíklad \emph{Intelligent Driver Model} (IDM), kterı si popíšeme pozdìji.

V~èlánku \cite{Newell} je pøesnì popsán nejen model, ale i jeho verifikace a porovnání s~ostatními modely. Pro nás je dùleitı popis modelu.

\subsection{Popis modelu}
Jestlie $n$-té vozidlo jede za $n-1$ vozidlem (které jede za $n-2$ vozidlem atd.), cíl kadého modelu sledu vozidel je zjistit závislost pozice $n$-tého vozidla  $x_{\n}(t)$ na $n-1$ vozidle, viz obrázek \ref{newell}. Jestlie se $n-1$ vozidlo pohybuje konstantní rychlostí $v$,
\[
x_{{\nm1}}(t) {}={} x_{\n}(t) + vt,
\]
$n$-té vozidlo také pojede prùmìrnou rychlostí $v$. Pokud by $n$-té vozidlo zrychlovalo, tak by došlo ke kolizi s~$n-1$ vozidlem a naopak pokud by zpomalovalo, tak by se $n$-té vozidlo neustále vzdalovalo. Toté platí pro všechna vozidla jedoucí za $n$-tım. Newellùv model se nezabıvá zjištìním hodnoty rychlosti $v$, pøedpokládá se, e je urèena buïto na základì omezení rychlosti èi podle konstrukèních moností vozidla.

\begin{figure}[ht]%
    \centering
    \includegraphics[]{images/newell2.pdf}%
    \caption[Trajektorie vozidel s~konstantní rychlostí - Newellùv model]{Trajektorie vozidel s~konstantní rychlostí, zdroj: \cite{Newell}}%
    \label{newell}%
\end{figure}

Vzdálenost $s_\n = x_{\nm1} (t) - x_\n (t)$ mezi vozidly $n$ a $n-1$ se mùe mìnit v~èase. Pokud je komunikace homogenní, tato vzdálenost zùstane témìø konstantní s mírnımi oscilacemi v okolí $s_n$. Tato hodnota se mìní na základì typu vozidla a závisí také na rychlosti $v$.

Pøedpokládejme, e existuje nìjakı empirickı vztah mezi rychlostí $v$ a vzdáleností mezi vozidly $s_\n$. Pokud rychlost $v$ roste, je logické, e øidièi chtìjí dosáhnout vìtšího rozestupu mezi vozidly. Tato  závislost mezi $v$ a $s_\n$ je znázornìna na obrázku \ref{vztahmezivas}. Kadı øidiè má svou preferovanou rychlost $V_\n$. Jestlie rychlost $v$ je u~$n-1$ vozidla je vyšší ne preferovaná rychlost u~$n$-tého, tedy $v>V_\n$, znamená to, e $n$-té vozidlo pojede svoji preferovanou rychlostí (na obrázku \ref{vztahmezivas} znázornìna èárkovanou èárou) a $n-1$ vozidlo mu ujede.
Hodnota rychlosti $v$ nemùe bıt záporná a vzdálenost mezi vozidly pøi nulové rychlosti by mìla bıt níe ne polopøímka lineární závislosti, viz èernı bod na obrázku \ref{vztahmezivas} pøi rychlosti $v=0$.

\begin{figure}[ht]%
    \centering
    \includegraphics[]{images/vztahmeziSaV2.pdf}%
    \caption[Vztah mezi rychlostí $v$ a vzdáleností mezi vozidly $s_\n$ - Newellùv model]{Vztah mezi rychlostí $v$ a vzdáleností mezi vozidly $s_\n$, zdroj: \cite{Newell}}%
    \label{vztahmezivas}%
\end{figure}

Nyní pøedpokládejme, e se $n-1$ vozidlo nìjakou dobu $t$ pohybuje konstantní rychlostí $v$\footnote{hodnota rychlosti osciluje okolo hodnoty $v$} a potom náhle zmìní rychlost na hodnotu $v'$. Trajektorie vozidel $n$ a $n-1$ mohou poté vypadat jako na obrázku \ref{linearaprox}. Z~obrázku lze také vypozorovat jak èasovou $\tau_\n$, tak prostorovou $d_\n$ mezeru mezi vozidly $n$ a $n-1$. Z~èárkovaného obdelníku poté dostáváme vztah vzdálenost mezi vozidly pøed zmìnou rychlosti $s_\n$ a po zmìnì rychlosti $s'_\n$,
\[
s_\n{}={}d_\n + v\tau_\n,\qquad s'_\n{}={}d_\n + v'\tau_\n.
\]

Z~toho vyplıvá, e pokud leí $v$ a $v'$ na polopøímce z~obrázku \ref{vztahmezivas}, sklon této pøímky je právì $\tau_\n$ a hodnota $s_n$ pøi rychlosti $v = 0$ je $d_\n$.

Ze vztahu mezi $v$ a $s_\n$, jak je zobrazeno na obrázku \ref{vztahmezivas}, plyne nezávislost mezer $d_\n$ a $\tau_\n$ na rychlostech $v$, resp. $v'$. Pokud se tedy zmìní rychlost z~hodnoty $v'$ na $v''$, $d_\n$ a $\tau_\n$ zùstanou pøi této zmìnì rychlosti stejné. Lineární trajektorie vozidla $x_n(t)$ potom bude jednoduše posun v~èase $\tau_\n$ a místì $d_\n$,
\begin{equation}
x_\n(t+\tau_\n) {}={} x_{\nm1}(t) - d_\n.
\label{eq:newelxn}
\end{equation}

U~Newellova modelu platí, e n-té vozidlo bude (pøiblinì) kopírovat trajektorii $n-1$ vozidla dle vztahu \eqref{eq:newelxn} pøi vhodnıch hodnotách $d_\n$ a $\tau_\n$. Tím, jak se pøesnì dokáe $n$-té vozidlo dodrovat vztah \eqref{eq:newelxn}, se Newellùv model nezabıvá, pouze pøedpokládá, e øidiè je schopen se tímto vztahem øídit. To není tak tìké, protoe pokud se zmìní rychlost vozidla $n-1$, $n$-tı øidiè nemusí zareagovat okamitì, ale mùe poèkat dokud se vzdálenost $s_\n$ nezvıší (neklesne) na hodnotu, která odpovídá nové rychlosti vozidla $n-1$ (viz obrázek \ref{vztahmezivas}).
\begin{figure}[ht]%
\centering
\includegraphics[]{images/linearaprox.pdf}%
\caption[Lineární aproximace pøi zmìnì rychlosti vozidel - Newellùv model]{Lineární aproximace pøi zmìnì rychlosti vozidel, zdroj: \cite{Newell}}%
\label{linearaprox}%
\end{figure}

Pøi pozorování se došlo k~závìru, e kadı øidiè nezkoumá všechna vozidla na komunikaci, ale pouze vozidla na vhodné \uv{makroskopické} èásti komunikace.

Hodnoty $\tau_\n$ a $d_\n$ jsou pøirozené, to vychází ze vztahu \eqref{eq:newelxn}, kde postupnım iterováním dostaneme
\begin{equation}
x_\n(t+\tau_\n + \tau_{\nm1} + \cdots + \tau_1) {}={} x_0(t) - d_\n - d_{\nm1} - \cdots - d_1.
\label{eq:newelxn0}
\end{equation}

Hodnoty $\tau_\n$ a $d_\n$ se znaènì liší mezi jednotlivımi vozidly v~závislosti na typu øidièe. První skupina øidièù radìji jede blíe vozidlu pøed sebou ($n-1$) a na minimální bezpeènou vzdálenost, zatímco druhá skupina naopak preferuje delší vzdálenost pro klidnou reakci na nenadálou událost. Je rozumné, aby se hodnoty $\tau_n$ a $d_\n$ lišily, a to tak, e kadému jednotlivému vozidlu budou hodnoty vygenerovány z~nìjakého pravdìpodobnostního rozdìlení, jeho variaèní koeficient se bude blíit jedné. Pøi generování rychlostí vozidel by naopak mìl bıt variaèní koeficient zanedbatelnı.

Poloíme-li
\begin{equation}
\overline{\tau}{}={}\frac{1}{n}\sum_{k=1}^n \tau_k,\qquad \overline{d}{}={}\frac{1}{n}\sum_{k=1}^n d_k,
\label{eq:averagedtau}
\end{equation}
kde $\overline{\tau}$ a $\overline{d}$ jsou prùmìrné posuny v~èase resp. místì, potom prùmìrnou vlnovou rychlost spoèteme jako podíl $\overline{d}/\overline{\tau}$.

Tento model se dá ovšem popsat nejen mikroskopicky (rychlost, mezera mezi vozidly), ale i makroskopicky (hustota $k$, intenzita $q$). Stacionární stav nastane ve chvíli, kdy se všechna vozidla budou pohybovat stejnou konstantní rychlostí s~rozdílnımi posuny (èasovımi i prostorovımi).

Jestlie
\[
s_\n{}={}d_\n + v\tau_\n,
\]
a rychlost vozidel je konstantní, tak platí
\[
\overline{s}{}={}\overline{d} + v\overline{\tau}.
\]

Hustotu $k$ lze potom vypoèítat jako pøevrácenou hodnotu prùmìrné mezery mezi vozidly $k{}={}1/\overline{s}$ a rychlost jako podíl intenzity a hustoty, to jest $v = q/k$. Tudí platí
\begin{equation}
q = \frac{1}{\overline{\tau}} - \frac{\overline{d}}{\overline{\tau}}k,
\label{eq:qk}
\end{equation}
za pøedpokladu, e rychlost $v$ je menší ne preferovaná rychlost jakéhokoliv vozidla $V_k$.

Rovnice \eqref{eq:qk} propojuje Newellùv model s~klasickımi makroskopickımi modely. Problém nastává ve chvíli, kdy prùmìrná rychlost $v$ je vyšší, ne nìkterá z~preferovanıch rychlostí jednotlivıch vozidel. Vozidla se v~tomto modelu nemohou pøedjídìt, a proto vznikne kongesce za vozidlem s~malou preferovanou rychlostí. V~následujících øádcích pøedpokládáme, e aktuální rychlost vozidla bude menší ne preferovaná rychlost $V_\n$.

Uvaujme, e se vozidlo $n$ pohybuje pøesnì podle rovnice \eqref{eq:newelxn} a vozidlo za ním ($n-1$) jede plynule za ním.

Rovnici \eqref{eq:newelxn} mùeme pøepsat do tvaru
\begin{equation}
x_\n(t+\tau_\n) {}={} x_\n(t) + \tau_\n v_\n(t+T),
\label{eq:xntaun}
\end{equation}
kde $T$ znaèí reakèní èas øidièe $n$.
\begin{comment}
Rovnice \eqref{eq:xntaun} lze pro rovnomìrnı pohyb zjednodušit na tvar
\[
x_\n(t+\tau_\n) {}={} x_\n(t) + \tau_\n v_\n(t).
\]
\end{comment}
Tvar rovnice \eqref{eq:xntaun} plyne z~matematické analızy\footnote{vìta o~støední hodnotì}, pøièem hodnota $T$ se nachází nìkde mezi nulou a $\tau_\n$. Pokud je funkce hladká bude pøiblinì
\begin{equation}
T = \frac{\tau_\n}{2}.
\label{eq:Tn}
\end{equation}

Rovnici \eqref{eq:xntaun} lze pøepsat na pøiblinı tvar
\begin{equation}
x_\n(t+\tau_\n) {}={} x_\n(t) + \tau_\n v_\n(t) + \tau_\n T a_\n(t),
\label{eq:xntaunx}
\end{equation}
kterı uvauje zrychlení vozidla $a_\n$\footnote{Pøedpokládejme vozidlo v~klidu, které se rozjídí. Na zaèátku zvolíme $\tau_\n = 5\,\text{s}, t = 0\,\text{s}, T = \tau_\n/2 = 2{,}5\,\text{s}$, potom platí
\[
x_\n(5) {}={} x_\n(0) + 5 v_\n(0 +2{,}5).
\]
Pro vıpoèet dráhy bereme hodnotu rychlosti v~èase 2{,}5\,s. Nemùeme vzít hodnotu v~nule, vozidlo by v~tomto pøípadì stálo na místì. Pøibliná hodnota bude tedy opravdu v~polovinì hodnoty $\tau_\n$.
}.
Kombinací rovnic \eqref{eq:xntaunx} a \eqref{eq:newelxn} dostáváme vztah pro rychlost
\begin{equation}
v_\n(t+\tau_\n) {}={} \frac{1}{\tau_\n}\left[x_{\nm1}(t)-x_\n(t)\right] - \frac{d_\n}{\tau_\n}.
\label{eq:xntaunv}
\end{equation}

Po zderivování rovnice \eqref{eq:xntaunv} dostáváme vztah pro zrychlení vozidla
\begin{equation}
a_\n(t+\tau_\n) {}={} \frac{1}{\tau_\n}\left[v_{\nm1}(t)-v_\n(t)\right].
\label{eq:xntauna}
\end{equation}
Z~rovnic \eqref{eq:xntaunv} a \eqref{eq:xntauna} je vidìt zøejmá závislost na vozidle, které jede pøed aktuálním,  èlenem $v_{\nm1}(t)$, resp. $x_{\nm1}(t)$. Øidiè volí svoji rychlost na základì odstupu od pøedchozího vozidla, resp. zrychlení na základì rychlostí.

Koneènı vztah pro Newellùv model je tedy
\begin{equation}
a_\n(t) {}={} \frac{ \displaystyle\frac{1}{\tau_\n}\left[v_{\nm1}(t)-v_\n(t)\right] - \frac{d_\n}{\tau_\n} - v_\n(t)}{T},
\label{eq:newellcompl}
\end{equation}
kde vztah mezi $\tau_\n$ a $T$ vychází z~rovnice \eqref{eq:Tn}.

U~Newellova modelu není vùbec definované èelní vozidlo a jeho vlastnosti. Je napø. moné nastavit mu konstantní rychlost a vlastnosti následujících vozidel vypoèítat poté rovnice \eqref{eq:newellcompl}.

\subsection{Parametry Newellova modelu}
\label{subsec:parameterNewell}
\begin{comment}
Koneènı vztah pro Newellùv model je tedy
\begin{equation}
a_\n(t) {}={} \frac{ \displaystyle\frac{1}{\tau_\n}\left[v_{\nm1}(t)-v_\n(t)\right] - \frac{d_\n}{\tau_\n} - v_\n(t)}{T}.
\label{eq:newellcompl}
\end{equation}
\end{comment}
Všechny promìnné a parametry Newellova modelu potom jsou:
\begin{itemize}
	\item $\tau_\n$ -- èasová mezera mezi vozidly,
	\item $T$ -- reakèní èas øidièe,
	\item $d_\n$ -- odstup mezi vozidly v~metrech,
	\item $v_\n (t)$ -- rychlost vozidla n v~èase $t$,
	\item $a_\n (t)$ -- zrychlení vozidla v~èase $t$.
\end{itemize}

Všechny parametry s~indexem $n-1$ mají stejnı vıznam, ale vztahují se k~vozidlu jedoucímu pøed aktuálním.

\section{Gippsùv model}
\label{sec:Gipps}

Další model, kterım se zde budeme zabıvat, navrhl v roce 1981 anglickı specialista na dopravní modelování P. G. Gibbs \cite{Gipps} a podle nìj se také model dnes jmenuje. Gibbsùv model vychází z Newellova modelu a na rozdíl od svého jednoduchého pøedchùdce se i dnes tento model vyuívá pro simulaci dopravy. 

Vìtšina modelù, které vznikly pøed Gippsovım, jsou rùzné variace na rovnici (Newellùv ovšem ne)
\begin{equation}
a_\n(t+T) {}={} l_n\frac{[v_{\nm1}(t) - v_\n(t)]^k}{[x_{\nm1}(t) - x_\n(t)]^m},
\label{eq:othermodels}
\end{equation}
kde jednotlivé promìnné mají stejnı vıznam jako pøi popisu Newellova modelu v podkapitole \ref{sec:Newell}. Promìnné $l_n$, $k$ a $m$ jsou parametry, které je nutno empiricky odhadnout. Tyto modely zaèaly vytváøet vızkumníci ve spoleènosti General Motors a z tohoto dùvodu se také nazıvají Modely General Motors. Blíe jsou rozebrány v~mé bakaláøské práci \cite{Vanis}.

Aèkoliv tyto modely podávají v~mnoha situacích dobré vısledky, je ádoucí, aby bìhem pøepoètù poloh, rychlostí a zrychlení vıpoèet závisel na reakèním èasu øidièe $T$. Další koncepèní slabinou GM modelù je fakt, e empirické parametry $l_n$, $k$ a $m$ v rovnici \eqref{eq:othermodels} nemají pøímou souvislost s~vlastnostmi vozidla èi øidièe.

Gipps se proto rozhodl, e vytvoøí model, kterı bude splòovat následujicí podmínky:

\begin{itemize}
	\item model by mìl napodobovat chování opravdového provozu,
	\item parametry modelu by mìly odpovídat vlastnostem øidièe a vozidla,
	\item model by se mìl chovat správnì i v~pøípadì, e doba mezi pøepoèítáváním polohy a rychlosti je stejná, jako reakèní èas øidièe.
\end{itemize}

\subsection{Popis modelu}

Gippsùv model je odvozen z~omezení jak schopností øidièe, tak i vozidla, a pomocí tìchto omezení se dopoèítává bezpeèná rychlost podle pøedcházejícího vozidla. Pøedpokládá se pøitom, e øidiè volí svoji rychlost tak, aby zajistil bezpeèné zastavení nebo aby dokázal náhle rychle zastavit pøi nenadálé události.

První podmínka, kterou aplikujeme na vozidlo $n$, souvisí s~rychlostí vozidla. Ta nepøekroèí jeho preferovanou rychlost $V_\n$ a jeho zrychlení na volné komunikaci\footnote{tj. komunikace, na které se nevyskytuje ádné další vozidlo} se zvyšuje stejnì tak, jako rychlost, dokud se také zvyšuje krouticí moment motoru vozidla a poté zaène klesat na nulovou hodnotu a té nabude ve chvíli, kdy se vozidlo bude pohybovat svoji preferovanou rychlostí $V_n$,
\begin{equation}
v_\n (t+T) {}\leq{} v_\n (t) + 2{,}5 \, a \, T \left(\frac{1-v_\n (t)}{V_\n}\right)\sqrt{\left(0{,}025+\frac{v_\n (t)}{V_\n}\right)}.
\label{eq:inequalitygipps}
\end{equation}

\begin{comment}
 Tento vıraz je zcela popisnı, pøesná forma zvolena z~nìkolika zároveò postaèujících popisù na základì jednoduše získanıch vıpoètù.
\end{comment}
Koeficienty v~nerovnici \eqref{eq:inequalitygipps} byly stanoveny na základì z~mìøení na hlavních dopravních komunikacích pøi prùmìrném provozu.  Vyuití nerovnice \eqref{eq:inequalitygipps} pro tento model je povaované za pøijatelné a do chvíle, kdy se vozidlo pøiblíí vozidlu jedoucím pøed ním. Od té chvíle dùraz na tuto podmínku klesá. Naopak nejvìtší váhu má tato podmínka ve chvíli, kdy vozidlo nemá nikoho pøed sebou èi vozidlo pøed ním se nachází velmi daleko. Vozidlo se tedy v tuto chvíli pohybuje volnou rychlostí (z angl. \textit{free-flow speed}).

Další omezení, které je nutno zmínit, se tıká brdìní. Jestlie $n-1$ (první) vozidlo zahájí brdìní v~èase $t$, zpomalí a následnì zastaví v~místì $x^*_{\nm1}$, které dostáváme rovnicí
%
\begin{equation}
    x^*_{\nm1} {}={} x_{\nm1} (t) - \frac{v_{\nm1} (t)^2}{2b_{\nm1}},
    \label{eq:cometorestnm1}
\end{equation}
kde èlen $b_{\nm1}$ oznaèuje nejvyšší kritickou decelaraci, kterou je øidiè vozidla $n-1$ schopen vykonat. Její hodnota je vdy záporná.

Vozidlo $n$, jedoucí za ním, nebude reagovat na toto zpomalení ihned, ale a v~èase $t + T$ a tudí zastaví a v~místì $x_\n^*$, daném rovnicí
%
\begin{equation}
    x_\n^* = x_\n (t) +\left[v_\n (t) + v_\n (t+T) \right] \frac{T}{2} - \frac{v_{n} (t+T)^2}{2b_\n}.
    \label{eq:cometorestn}
\end{equation}
%
Pro vlastní bezpeènost musí øidiè vozidla $n$ zajistit, e bude splnìna podmínka
%
\begin{equation}
x^*_{\nm1} - l_{\nm1} < x_\n^*,
\label{eq:distance}
\end{equation}
kde $l_{\nm1}$ je délka vozidla $n-1$, seètena s~bezpeènou vzdáleností následujícího ($n$-tého) vozidla. Pokud podmínka \eqref{eq:distance} neplatí, $n$-té vozidlo nemá ádnı prostor pro pøípadnou øidièovu chybu. Z~toho dùvodu obsahuje Gippsùv model ještì další podmínku, udávající dodateènou èasovou rezervu øidièe pro bezpeènı odstup, $\theta$. Jak ji víme, øidiè zaène reagovat na vozidlo pøed sebou a v~èase $t+T$. Od této chvíle tedy máme reakèní èas~$T$ a bezpeènı reakèní èas $T + \theta$, kterı budeme ve vıpoètech dále vyuívat. S~vyuitím rovnic \eqref{eq:cometorestnm1} a \eqref{eq:cometorestn} mùeme podmínku \eqref{eq:distance} pøepsat do nerovnice
%
\begin{multline}
x_{\nm1} (t) - \frac{v_{\nm1} (t)^2}{2b_{\nm1}} - l_{\nm1} \geq  x_\n (t) +\\
+\left[v_\n (t) + v_\n (t+T) \right] \frac{T}{2} + v_\n (t+T) \theta - \frac{v_{\n} (t+T)^2}{2b_\n}.
\label{eq:theta}
\end{multline}

Bez parametru $\theta$ by øidiè vozidla byl nucen brzdit a ve chvíli, kdy opravdu musí, to znamená na maximální vıkon brzd. Do té chvíle by se stále pohyboval svou preferovanou rychlostí. Parametr $\theta$ slouí k~døívìjšímu a pøitom ne tak prudkému brdìní.

Pøi skuteèném pozorování dopravy jsme schopni zmìøit všechny parametry vozidla $n$ v~rovnici \eqref{eq:theta} kromì èlenu $b_{\nm1}$. Tento èlen nahradíme odhadnutou hodnotou $\hat{b}$, upravíme tuto rovnici a dostáváme
\begin{multline}
- \frac{v_{n} (t+T)^2}{2b_{\n}} + v_\n (t+T) \left(\frac{T}{2} + \theta\right) -\\
- \left[x_{\nm1} (t) - l_{\nm1} - x_\n (t)\right] + v_{\n} (t) \frac{T}{2} + \frac{v_{\nm1} (t)^2}{2\hat{b}} \leq 0.
\label{eq:replacebn}
\end{multline}

Relativní hodnoty $T$ a $\theta$ jsou dùleité v~urèování chování vozidel. Za normálních okolností se dosazuje za $\theta = T/2$. Díky tomu mùeme rovnici \eqref{eq:replacebn} pøepsat do tvaru
\begin{equation}
- \frac{v_{n} (t+T)^2}{2b_\n} + v_\n (t+T) T - \left[x_{\nm1} (t) - l_{\nm1} - x_\n (t)\right] + v_{\n} (t) \frac{T}{2} + \frac{v_{\nm1} (t)^2}{2\hat{b}} \leq 0.
\label{eq:replacetheta}
\end{equation}

Z~toho po sloitıch úpravách plyne
\begin{equation}
v_{\n} (t+T) \leq b_\n T + \sqrt{\left(b^2 T^2 - b\left(2\left[x_{\nm1} (t) - l_{\nm1} - x_\n (t)\right] - v_{\n} (t)T - \frac{v_{\nm1} (t)^2}{2\hat{b}} \right)\right)}.
\label{eq:nextreplace}
\end{equation}

Z~nerovnice \eqref{eq:replacetheta} vychází, e bezpeèné rychlosti $v_\n$ budou leet mezi dvìma koøeny této nerovnice. Pokud bude mít spodní koøen zápornou hodnotu, mùeme jej ignorovat, protoe nás zajímají pouze kladné hodnoty rychlostí. Zároveò tedy musí platit
\begin{equation}
v_{\n} \geq 0.
\label{eq:vsafegipps0}
\end{equation}
Podcenìní plynulého brdìní øidièe vozidla $n$ nastane ve chvíli, kdy
\[
v_{\n} (t+T) < v_\n (t) + b_n T.
\]
V~tuto chvíli musí vozidlo zaèít brzdit rychleji, ne by sám øidiè chtìl. Øidiè tedy volí rychlost na základì preferované decelarace, ale mùe brzdit i silnìji, pokud by to bylo nutné.

Nerovnice \eqref{eq:inequalitygipps} pro vozidlo $n$ na volné komunikaci a \eqref{eq:nextreplace} pro vozidlo $n$, pøed kterım se nachází vozidlo $n-1$, pøedstavují dvì hlavní podmínky pro rychlost $v_\n$ v~èase $t + T$. Jestlie øidiè pøizpùsobí rychlost parametrùm vozidla tak, aby jízda byla bezpeèná, dostáváme \textbf{koneènı vztah pro Gippsùv model:}
\begin{equation}
\label{eq:gipps}
\begin{split}
v_{\n} (t+&\,T) = \min \left( v_\n (t) + 2,5\,a\,T \left(1-\frac{v_\n (t)}{V_\n}\right)\sqrt{\left(0,025+\frac{v_\n (t)}{V_\n}\right)},\right.\\
&\left. b\,T + \sqrt{\left(b^2 T^2 - b\left(2\left[x_{\nm1} (t) - l_{\nm1} - x_\n (t)\right] - v_{\n} (t)T - \frac{v_{\nm1} (t)^2}{2\hat{b}} \right)\right)}\;\right)
\end{split}
\end{equation}

Pokud platí pro témìø všechna vozidla niší hodnota v~rovnici \eqref{eq:gipps}, vychází se z~nerovnice \eqref{eq:nextreplace}, vozidla jedou blízko sebe, z~èeho vyplıvá vysoká hustota provozu. Pokud platí opak, tzn. nerovnice \eqref{eq:inequalitygipps}, dopravní proud je volnı.

\subsection{Parametry Gippsova modelu}
\label{subsec:parameterGipps}
Všechny promìnné a parametry Gippsova modelu potom jsou:
\begin{itemize}
	\item $T$ -- reakèní èas øidièe,
	\item $v_\n (t)$ -- rychlost vozidla $n$ v~èase $t$,
	\item $a$ -- maximální hodnota zrychlení, kterım je øidiè ochoten zrychlovat -- \emph{nikoliv tedy zrychlení vozidla v~èase $t$!},
	\item $V_\n$ -- preferovaná rychlost vozidla $n$,
	\item $b$ -- maximální decelerace vozidla, kterou je øidiè ochoten brzdit,
	\item $x_\n (t)$ -- poloha vozidla $n$,
	\item $l_{\nm1}$ -- délka vozidla $n-1$ seètena s~bezpeènou vzdáleností $n$-tého vozidla,
	\item $\hat{b}$ -- odhadnutá hodnota decelerace $b_{\nm1}$.
\end{itemize}





\section{Kraussùv model}
\label{sec:Krauss}
\begin{comment}
Pro simulaci v~této práci budeme vyuívat software SUMO\footnote{Simulation of Urban MObility} a souèástí tohoto programu je pøedpøipravenı Kraussùv model vytvoøenı v~rámci disertaèní práce stejnojmeného autora.  \rem{preformulovat}
\end{comment}

Tento model vytvoøil S. Krauss na Universität Köln v rámci své disertaèní práce \cite{Krauss}. V popisu modelu v této podkapitole z tohoto zdroje také vycházím.  

Tento model se hlavnì zamìøuje na vlastnosti dopravního proudu, zkoumání chování øidièe zde není primární. Myšlenka autora je taková, e existují obecné vlastnosti dopravního proudu, ze kterıch vyplıvá chování jednotlivıch úèastníkù silnièního provozu a chování jednotlivce vıznamnì neovlivòuje vlastnosti dopravního proudu.

\subsection{Obecnı pøístup}
\label{krauss:approach}
Pokud se dopravní proud modeluje mikroskopicky, musí bıt brány v~úvahu dva typy pohybu vozidla. Prvním typem pohybu je vozidlo jedoucí po vozovce osamoceno, zatímco ve druhém pøípadì vozidlo interaguje s~ostatními vozidly. Na základì tìchto pohybù pøedpokládáme následující podmínky. První podmínka má pøímo souvislost s~rychlostí vozidla. Ta je omezena nìjakou maximální rychlostí $v_{\max}$,
\begin{equation}
v(t) \leq v_{\max}.
\label{eq:kraussvmax}
\end{equation}
Za maximální rychlost mùe bıt napøíklad zvolena preferovaná rychlost vozidla.

Hlavní dùvod, proè mezi sebou vozidla interagují, je fakt, e øidièi nemají v~úmyslu sráet se s~ostatními vozidly. Další podmínkou tedy bude tzv. \uv{nekoliznost} systému. Budeme pøedpokládat, e øidiè vozidla zvolí tedy takovou rychlost vozidla, která nebude vyšší ne maximální bezpeèná rychlost $v_{\safe}$,
\begin{equation}
v (t) \leq v_{\safe} (t).
\label{eq:kraussvsafe}
\end{equation}
Z~maximální bezpeèné rychlosti poté plyne interakce mezi vozidly. Její stanovení bude uvedeno dále.

Je moné formulovat modely na základì podmínek \eqref{eq:kraussvmax} a \eqref{eq:kraussvsafe}. Nicménì je vhodné pøedpokládat také omezující podmínky pro akceleraci $a$ a deceleraci $b$,
\begin{equation}
\begin{split}
&-b \leq \frac{\dd v}{\dd t} \leq a,\\
&a,b > 0.
\label{eq:kraussa}
\end{split}
\end{equation}
Pozdìji bude ukázáno, e vztah \eqref{eq:kraussa} je nezbytnou podmínkou správného modelování dopravního proudu.

Pøedchozí podmínky mùeme shrnout do následující nerovnice
\begin{equation}
v(t+ \Delta t) \leq \min (v_{\max}, v_{\safe}, v(t)+a \Delta t),
\label{eq:kraussvtdt}
\end{equation}
kde maximální bezpeèná rychlost $v_{\safe}$ musí splòovat podmínku
\begin{equation}
v(t+ \Delta t) \geq v(t) - b\Delta t.
\label{eq:kraussvsafecalc}
\end{equation}

Celkové povìdomí o~tom, jak se jednotlivá vozidla pohybují a interagují mezi sebou, závisí na vıpoètu maximální bezpeèné rychlosti $v_{\safe}$. Jakmile je stanovena hodnota $v_{\safe}$, nerovnice \eqref{eq:kraussvtdt} pøedstavuje schéma pro simulace dopravního proudu, pokud jsou splnìny všechny podmínky zmínìné vıše.

\subsection{Interakce mezi vozidly}

Kadı sofistikovanı dopravní model by mìl obsahovat interakci mezi vozidly. Pøedstavme si dvì vozidla na komunikaci, první vozidlo se nachází v~bodì $x_1 (t)$ a jede rychlostí $v_1 (t)$, vozidlo, které ho následuje se nachází v~bodì $x_f (t)$ a pohybuje se rychlostí $v_f (t)$. Jestlie délka prvního vozidla bude $l$, mezera mezi vozidly se vypoète vztahem
\begin{equation}
g(t) = x_1(t) - x_f(t) - l.
\label{eq:kraussgap}
\end{equation}

Jak ji bylo zmínìno, hlavním dùvodem, proè mezi sebou vozidla interagují, je fakt, e øidièi nemají v~úmyslu sráet se s~ostatními vozidly. Z~toho plyne, e mezera mezi vozidly musí bıt nezáporná. Narozdíl od jinıch modelovacích pøístupù, zde nezaèneme s~pøedpokladem, e se zrychlení vozidla vypoète ze zrychlení vozidla jednoucího pøed ním, protoe tím nekoliznost stejnì není zajištìna automaticky.

Místo toho zavedeme pravidlo, e se spolu interagující vozidla ve spojitıch modelech nesrazí tehdy, pokud je mezera mezi vozidly $g$ vìtší ne nìjaká preferovaná mezera mezi vozidly $g_{\des}$ a splòuje tuto dynamickou nerovnici
\begin{equation}
\frac{\dd g (t)}{\dd t} \geq \frac{g_{\des} - g (t)}{\tau_{\des}}.
\label{eq:kraussgapdes}
\end{equation}

Preferovanı bezpeènı èasovı odstup mezi vozidly $\tau_{\des}$ a preferovaná mezera $g_{\des}$ by mohly bıt funkcemi odstupu mezi vozidly èi jejich rychlostmi, ale v tomto pøípadì to jsou konstanty. Fakt, e v~tomto modelu nemohou nastat kolize, je zøejmı, protoe pokud poloíme $g$ rovné nule, èasová derivace v rovnici \eqref{eq:kraussgapdes} bude vdy nezáporná nebo nutnì $g_{\des} > 0$ a $\tau_{\des} > 0$.

Uvaujme stále pøípad dvou vozidel jedoucími rychlostmi $v_1 (t)$, resp. $v_f (t)$ s~odstupem $g (t)$. Druhé vozidlo jede svou bezpeènou rychlostí a øidiè tohoto vozidla mùe zastavit za jakıchkoli okolností tak, aby nedošlo ke kolizi s~prvním vozidlem. To znamená, e pokud øidiè má reakèní èas $T$ a brzdná vzdálenost vozidel jedoucích rychlostí $v (t)$ je dána funkcí $f(v(t))$, je situace bezpeèná právì tehdy, kdy
\begin{equation}
f(v_f(t)) + v_f(t) T \leq f(v_1(t)) + g(t).
\label{eq:kraussdvsafe}
\end{equation}

Hodnota funkce $f(v_f(t))$ èi $f(v_1(t))$ nemusí bıt nutnì minimální moná brzdná vzdálenost, ale mùe to bıt funkce závisející na zpùsobu øízení øidièe. To samé platí pro reakèní èas $T$.

Úprava nerovnice \eqref{eq:kraussdvsafe} vede k~bezpeènostnímu pravidlu pro rychlost druhého vozidla. Nicménì my toto pravidlo neodvozujeme ze dvou dùvodù. První z~nich je ten, e po úpravì bychom potøebovali znát pøesnı pøedpis funkce $f(v_f(t))$ èi $f(v_1(t))$, kterı, jak uvidíme, není moné zjistit. V druhém pøípadì je nesmyslné a zbyteèné poèítat monou strategii øidièe ve chvíli nenadálé události a tím pádem také vypoèítávat decelaraci a k~úplnému zastavení kadı jednotlivı krok. Proto zavedeme Taylorùv rozvoj brzdné vzdálenosti okolo prùmìrné rychlosti obou vozidel,
\begin{equation}
\overline{v}(t) = \frac{v_1(t) + v_f(t)}{2}.
\label{eq:kraussv1vf}
\end{equation}

Taylorùv rozvoj je obecnì definován následovnì 
\begin{equation}
f(x) = f(a) + \frac{f^{(1)}(a)}{1!} (x - a) + \frac{f^{(2)}(a)}{2!} (x - a)^2 + \frac{f^{(3)}(a)}{3!} (x - a)^3 \dots,
\label{eq:taylor}
\end{equation}
kde $a$ je bod, ve kterém budeme funkci rozvíjet a horní indexy u funkcí znaèí pøíslušnou derivaci.

Budeme pro zjednodušení uvaovat pouze první 4 èleny Taylorova rozvoje. Potøebujeme rozvinout funkce $f(v_1(t))$ a $f(v_f(t))$ z rovnice \eqref{eq:kraussdvsafe} v okolí bodu $\overline{v}(t)$ z rovnice \eqref{eq:kraussv1vf}. Po vyjadøení funkce $f(v_1(t))$ Taylorovım rozvojem, rovnice \eqref{eq:taylor}, dostáváme
\begin{equation}
\begin{split}
f(v_1(t)) &= f(\overline{v}(t)) + \frac{f^{(1)}(\overline{v}(t))}{1!} \left(v_1(t) - \frac{v_1(t) + v_f(t)}{2}\right) \\
&+ \frac{f^{(2)}(\overline{v}(t))}{2} \left(v_1(t) - \frac{v_1(t) + v_f(t)}{2}\right)^2 + \frac{f^{(3)}(\overline{v}(t))}{6} \left(v_1(t) - \frac{v_1(t) + v_f(t)}{2}\right)^3,
\end{split}
\label{eq:taylorfv1}
\end{equation}
kde po úpravách závorek dostaneme
\begin{equation}
\begin{split}
f(v_1(t)) &= f(\overline{v}(t)) + \frac{f^{(1)}(\overline{v}(t))}{1!} \left(\frac{v_1(t) - v_f(t)}{2}\right) \\
&+ \frac{f^{(2)}(\overline{v}(t))}{2} \left(\frac{v_1(t) - v_f(t)}{2}\right)^2 + \frac{f^{(3)}(\overline{v}(t))}{6} \left(\frac{v_1(t) - v_f(t)}{2}\right)^3.
\end{split}
\label{eq:taylorfv1}
\end{equation}
Stejnı postup provedeme i pro $f(v_f(t))$
\begin{equation}
\begin{split}
f(v_f(t)) &= f(\overline{v}(t)) + \frac{f^{(1)}(\overline{v}(t))}{1!} \left(\frac{v_f(t) - v_1(t)}{2}\right) \\
&+ \frac{f^{(2)}(\overline{v}(t))}{2} \left(\frac{v_f(t) - v_1(t)}{2}\right)^2 + \frac{f^{(3)}(\overline{v}(t))}{6} \left(\frac{v_f(t) - v_1(t)}{2}\right)^3.
\end{split}
\label{eq:taylorfvf}
\end{equation}
a oba tyto rozvoje dosadíme do rovnice \eqref{eq:kraussdvsafe}. Protoe platí
\begin{equation}
\left(\frac{v_f(t) - v_1(t)}{2}\right)^k = \left(\frac{v_1(t) - v_f(t)}{2}\right)^k,
\label{eq:vfv1}
\end{equation}
kde $k$ je sudé èíslo, vyruší se všechny sudé èleny tohoto rozvoje a zanedbáním vyšších øádù dostáváme
\begin{equation}
f^{(1)}(\overline{v}(t)) \frac{v_f(t) - v_1(t)}{2} + v_f(t) T \leq f^{(1)}(\overline{v}(t)) \frac{v_1(t) - v_f(t)}{2} + g(t).
\label{eq:krausstaylorcompare}
\end{equation}
Po roznásobení a pøevedení èlenù rovnice na opaèné strany získáme
\begin{equation}
f'(\overline{v}(t))v_f + v_f T \leq f'(\overline{v}(t))v_1 + g,
\label{eq:kraussdvsafeaverage}
\end{equation}
kde budeme nyní první derivaci znaèit $f'$.

Smysl derivace $f'(\overline{v})$ vysvìtlíme jednoduše. Pokud se podívame na decelaraci vozidla $b$ z~rychlosti $v$ na nulu (nemusí bıt nutnì konstantní), tedy $\frac{\dd \overline{v}}{\dd t} = -b(v)$, kdy $b(v)>0$, obdríme vztah
\begin{equation}
f'(\overline{v}(t)) = -\frac{\dd}{\dd \overline{v}(t)}\int_v^0 \frac{\overline{v}(t)'}{b(\overline{v}(t)')} \dd v' = \frac{\overline{v}(t)}{b(\overline{v}(t))}.
\label{eq:kraussintegratebv}
\end{equation}

Nyní mùeme pøepsat podmínku bezpeènosti do tvaru
\begin{equation}
v_1 - v_f \geq \frac{v_1 T - g}{\displaystyle \frac{\overline{v}}{b(\overline{v})} + T},
\label{eq:krausssafetycond}
\end{equation}
kde
\begin{equation}
v_1 - v_f = \frac{\dd g}{\dd t}.
\label{eq:krausssdgdt}
\end{equation}

Nerovnice \eqref{eq:krausssafetycond} se rovná nerovnici \eqref{eq:kraussgapdes} ve chvíli, kdy je preferovanı odstup $g_{\des} = v_1 t$ a preferovanı bezpeènı èasovı odstup mezi vozidly $\tau_{\des} = \tau_b + T$, kde $\tau_b = \overline{v}(t)/b(\overline{v}(t))$ je stanoven na základì decelerací, které øidiè vyuije.

\subsection{Diskretizace modelu}

Pro monost simulace na poèítaèi je potøeba pøevést spojité nerovnice odvozené v~èásti \ref{krauss:approach} na diskrétní rovnice pro dráhy, rychlosti a zrychlení.

Vhodná cesta pro diskretizaci rovnic dynamického systému z~bezpeènostní podmínky \eqref{eq:kraussgapdes} je pøevést spojitou rychlost $v_f$ ve vırazu $g'(t) = v_1(t) - v_f(t)$ jako rychlost diskrétní s~diferencí èi integraèním krokem $\Delta t$. Potom nerovnici \eqref{eq:kraussgapdes} pøepíšeme do tvaru
\begin{equation}
v_f (t + \Delta t) \leq v_1(t) + \frac{g(t) - g_{\des}}{\tau_{\des}}.
\label{eq:krausssdiscvf}
\end{equation}
Rovnice pro polohu vozidla se potom na stejném principu pøevede na
\begin{equation}
x (t + \Delta t) = x(t) + v(t + \Delta t)\Delta t.
\label{eq:krausssdiscx}
\end{equation}
Víme, e pøi $\Delta t \rightarrow 0$ a $g_{\des} \geq 0$ nerovnice \eqref{eq:krausssdiscvf} a rovnice \eqref{eq:krausssdiscx} garantují nekoliznost vozidel. Pro koneènı èas $\Delta t$ musí bıt tato garance opìt dokázána.

Mezera $g(t)$ mezi dvìma vozidly je diskretizována vztahem
\begin{equation}
g (t + \Delta t) = g(t) + (v_1(t + \Delta t) - v_f(t + \Delta t))\Delta t.
\label{eq:krausssdisgap}
\end{equation}
Dosazení za $v_f (t + \Delta t)$ z rovnice \eqref{eq:krausssdiscvf} dostáváme
\begin{equation}
\xi (t + \Delta t) = \xi(t) + \left(1 - \frac{\Delta t}{\tau_b + T}\right) + \frac{g_{\des} - v_1(t)\Delta t}{\tau_b + T}\Delta t,
\label{eq:krausssdisxit}
\end{equation}
kde
\[
\xi (t) = g(t)  - v_1(t) \Delta t.
\]
Bezpeènost ($g \geq 0$) je tedy garantována tehdy, kdy platí:
\begin{equation}
\begin{split}
&\xi (t=0) \geq 0,\\
&\Delta t \leq T,\\
&g_{\des} \geq v_1 \Delta t.
\label{eq:krausssafetygarance}
\end{split}
\end{equation}
To je vısledek, kterı se ovšem dal pøedpokládat. Záleí pouze na tom, zda je i po provedení iteraèního kroku stále splnìna podmínka bezpeènosti, tzn. kontrolovat jestli je náš iteraèní krok menší ne reakèní èas øidièe $T$.

\subsection{Rovnice modelu}

Pøedpokládáme tedy, e se kadé vozidlo pohybuje nejvyšší rychlostí na základì podmínek, které jsou stanoveny níe. \textbf{Kraussùv model tedy stanovíme následujícími rovnicemi:}
\begin{equation}
\begin{split}
&v_{\safe} (t) = v_1(t) + \frac{g(t) - g_{\des}}{\tau_b + T},\\
&v_{\des} = \min \left(v_{\max}, v(t) + a(t) \Delta t, v_{\safe} (t)\right),\\
&v (t + \Delta t) = \max(0, v_{\des} - \eta).
\label{eq:krausssmodel}
\end{split}
\end{equation}

Novì zde také zavádíme promìnnou $\eta$, která je náhodnou vıchylkou od bìného øízení. Preferovaná mezera $g_{\des}$ mùe bıt zvolena rùznì. Vìtšinou se volí $g_{\des} = v_1 \tau$, kde $\tau$ je reakèní èas øidièe. Hodnota $\tau_b$ je definována jako podíl $\overline{v}/b$, kde $\overline{v}$ plyne ze vztahu \eqref{eq:kraussv1vf}. Volba integraèního kroku $\Delta t$ a preferované mezery $g_{\des}$ je závislá na podmínkách \eqref{eq:krausssafetygarance}.



\subsection{Parametry Kraussova modelu}
\label{subsec:parameterKrauss}
Všechny promìnné a parametry Kraussova modelu potom jsou:
\begin{itemize}
	\item $g (t)$ -- mezera mezi vozidly v~èase $t$,
	\item $g_{\des}$ -- preferovaná mezera mezi vozidly,
	\item $\tau_b$ -- èas závislı na rychlosti decelerace,
	\item $T$ -- reakèní èas øidièe,
	\item $v_1 (t)$ -- rychlost aktuálního vozidla v~èase $t$,
	\item $a (t)$ -- zrychlení v~èase $t$,
	\item $\Delta T$ -- integraèní krok,
	\item $\eta$ -- náhodná vıchylka od bìného øízení.
\end{itemize}


\section{Rozšíøenı Kraussùv model}
\label{exKrauss}

Hlavní zdroj pro vylepšení Kraussova modelu je pøímo èlánek pro implementaci Rozšíøeného Kraussova modelu \cite{Song}. Základ pro vznik tohoto vylepšení Kraussova modelu plyne z~procesu brdìní.

\subsection{Proces brdìní}

Fáze brzdicího procesu na sebe plynule navazují, první z~nich se nazıvá doba reakce øidièe $T$, dále zvyšování decelarace $t_\ii$ a maximální brdìní $t_\cc$. Vše je graficky znázornìno na obrázku \ref{brzdeni}. 

\begin{figure}%
\centering
\includegraphics[width=0.6\textwidth]{images/kraussbrzdeni.pdf}%
\caption[Fáze brdìní - Rozšíøenı Kraussùv model]{Fáze brdìní, zdroj: \cite{Song}}%
\label{brzdeni}%
\end{figure}

\paragraph{Doba reakce øidièe:} Øidiè potøebuje urèitı èas $T$ na to, aby zareagoval na zmìnu chování vozidla pøed sebou. V~dobì této reakce se pohybuje rychlost vozidla $v_0$ na konstantní hodnotì, pøípadnì se lehce mìní. Posunutí aktuálního vozidla je potom dáno rovnicí
\begin{equation}
S_\rr = v_0 T.
\label{eq:posunkrauss}
\end{equation}

\paragraph{Zvyšování decelerace:} Decelarace aktuálního vozidla se ve druhé fázi zvyšuje z~nuly na hodnotu $b_{\max}$, která pøedstavuje nejvyšší hodnotu decelerace vozidla. Pøedpokládáme lineární zvyšování decelarace,
\[
b = b_{\max} \frac{t}{t_\ii}.
\]
Aktuální rychlost vozidla se potom vypoète jako
\begin{equation}
v_i = v_0 - \int_0^{t_\ii}{b_{\max}\frac{t}{t_\ii} \dd t} = v_0 - \frac{b_{\max}}{2t_\ii} t^2,
\label{eq:speedKrauss}
\end{equation}
a v~této èásti vozidlo urazí vzdálenost
\begin{equation}
S_i = \int_0^{t_\ii}{\left(v_0 - \frac{b_{\max}}{2t_\ii} t^2\right) \dd t} = v_0 t_i - b_{\max} \frac{b_{\max} t_\ii^2}{6}.
\label{eq:moveKrauss}
\end{equation}

\paragraph{Maximální brdìní:}
V~tuto chvíli ji vozidlo brzdí svoji maximální decelerací $b_{\max}$, pohyb vozidla je potom dán vzorcem
\begin{equation}
S_c = \frac{v_0^2}{2b_{\max}} - \frac{v_0 t_i}{2} + \frac{b_{\max} t_i^2}{8}.
\label{eq:moveMaxDecelKrauss}
\end{equation}

\paragraph{Celková dráha pøi brdìní:}
Celková dráha pøi brdìní vozidla se vypoèítá jako souèet tøí pøedcházejících èástí, tedy
\[
S~= S_r + S_i + S_c = v_0 T + v_0 t_i - b_{\max} \frac{b_{\max} t_i^2}{6} + \frac{v_0^2}{2b_{\max}} - \frac{v_0 t_i}{2} + \frac{b_{\max} t_i^2}{8},
\]

a po úpravách dostaneme vztah
\begin{equation}
S~= v_0 T + \frac{1}{2} v_0 t_i + \frac{v_0^2}{2b_{\max}} - \frac{b_{\max} t_i^2}{24} \approx v_0 \left(t_r + \frac{1}{2}t_i \right) + \frac{v_0^2}{2b_{\max}},
\label{eq:MoveTogetherKrauss}
\end{equation}
kde èlen $- \frac{b_{\max} t_i^2}{24}$ zanedbáme, jeliko má nìkolikanásobnì menší hodnotu ne ostatní.

\subsection{Matematickı popis}

Klíè ke správnému modelu sledu vozidel je dle Krausse je hlavnì bezpeèná rychlost. Pokud èelní vozidlo sníí rychlost, aktuální vozidlo musí zaèít brzdit. Pokud obì vozidla zastaví, jejich polohu bude mono vypoèíst na základì vztahu
\begin{equation}
S_\ll + g(t) = S_\ff,
\label{eq:diffdispKrauss}
\end{equation}
kde $S_\ll$ pøedstavuje polohu èelního vozidla, $g (t)$ mezeru mezi obìma vozidly a $S_\ff$ polohu aktuálního vozidla.

Pokud pomineme reakèní èas èelního øidièe, brdìní se skládá ze dvou èástí probíhajících v~èase: zvyšování decelarace $t_{\ll\ii}$ a doby maximálního brdìní $t_{\ll\cc}$. Poloha èelního vozidla je v~celém brzdicím prùbìhu dána rovnicí
\begin{equation}
S_\ll = S_{\ll\ii} + S_{\ll\cc} = \frac{1}{2} v_\ll t_{\ll\ii} + \frac{v_\ll^2}{2a_{\max}} - \frac{b_{\max} t_{\ll\ii}^2}{24} \approx \frac{1}{2} v_\ll t_{\ll\ii} + \frac{v_\ll^2}{2a_{\max}},
\label{eq:S_lKrauss}
\end{equation}
kde $a_{\max}$ je maximální decelerace èelního vozidla. 

Poloha aktuálního vozidla (vozidla jedoucího za èelním) je v~celém brzdicím procesu rovna
\begin{equation}
\begin{aligned}
S_\ff = S_\rr + S_\ii + S_\cc = v_{\safe} T + \frac{1}{2} v_{\safe} t_{\ii} + \frac{v_{\safe}^2}{2b_{\max}} - &\frac{b_{\max} t_{\ff\ii}^2}{24} \approx\\ &v_{\safe} \left(T + \frac{1}{2}t_{\ff\ii} \right) + \frac{v_{\safe}^2}{2b_{\max}}.
\end{aligned}
\label{eq:S_fKrauss}
\end{equation}

Pokud do rovnice \eqref{eq:diffdispKrauss} dosadíme za $S_\ll$ z rovnice \eqref{eq:S_lKrauss} a za $S_\ff$ z rovnice \eqref{eq:S_fKrauss} dostáváme
\begin{equation}
v_{\safe} \left(t_\rr + \frac{1}{2}t_{\ff\ii} \right) + \frac{v_{\safe}^2}{2b_{\max}} - \frac{1}{2} v_\ll t_{\ll\ii} - \frac{v_\ll^2}{2a_{\max}} - g = 0.
\label{eq:vsafeKrauss0}
\end{equation}
Z~této rovnice u mùeme pøes vıpoèet diskriminantu vyjádøit $v_{\safe}$,
\begin{equation}
v_{\safe} = -b \left(T + \frac{t_{\ff\ii}}{2}\right) + \sqrt{b^2 \left(t_\rr + \frac{t_{\ff\ii}}{2}\right)^2 + b\left(v_\ll t_{\ll\ii} + \frac{v_\ll^2}{a} + 2g\right)}.
\label{eq:vsafeKrauss}
\end{equation}

V~simulaci je potom èas decelerace stejnı $t_i = t_{\ll\ii} = t_{\ff\ii}$, a~z~toho plyne
\begin{equation}
v_{\safe} = -b \left(T + \frac{t_{\ii}}{2}\right) + \sqrt{b^2 \left(T + \frac{t_{\ii}}{2}\right)^2 + b\left(v_\ll t_{\ii} + \frac{v_\ll^2}{a} + 2g\right)}.
\label{eq:vsafeKraussti}
\end{equation}
Pokud èelní vozidlo stojí, je jeho rychlost $v_\ll = 0\,\text{ms}^{-1}$ a jeho poloha se nemìní $S_\ll = 0$, rovnici \eqref{eq:vsafeKraussti} mùeme zjednodušit na
\begin{equation}
v_{\safe} = -b \left(T + \frac{t_{\ii}}{2}\right) + \sqrt{b^2 \left(T + \frac{t_{\ii}}{2}\right)^2 + 2bg}.
\label{eq:newKrauss}
\end{equation}

Tato rovnice \eqref{eq:newKrauss} je  jakımsi doplòkem ke Kraussovu modelu, pouze pøesnìji definuje bezpeènou rychlost. Princip Kraussova modelu stále zùstává ve volbì preferované rychlosti, kterou se vozidlo bude pohybovat. Tato volba je dána hodnotou $v_{\des}$ v~rovnici \eqref{eq:krausssmodel}.

\subsection{Parametry Rozšíøeného Kraussova modelu}
\label{subsec:parameterAddKrauss}
Všechny promìnné a parametry Kraussova modelu potom jsou:
\begin{itemize}
	\item $g$ -- aktuální mezera mezi vozidly,
	\item $b$ -- aktuální decelerace,
	\item $t_i$ -- èas, pøi kterém je zvyšována decelerace,
	\item $T$ -- reakèní èas øidièe.
\end{itemize}


\section{Intelligent Driver Model}
\label{sec:IDM}
Intelligent Driver Model (dále jen IDM) je pomìrnì novı matematickı model z~roku 2000, kterı byl vymyšlen v~Nìmecku. Pouívá se jinı pøístup vıpoètu akcelerací vozidel, kde se nevybírá z nìkolika hodnot (viz Gipps èi Krauss), ale dùleitost jednoho èlenu klesá v závislosti na vzdálenosti mezi vozidly.

V~této sekci budeme primárnì vycházet z~prací \cite{Vanis} a \cite{TreiberWWW}.
\subsection{Matematickı popis}
\label{sec:matpopisIDM}

Pro vıpoèet zrychlení v~IDM je pouit vztah
\begin{equation}
v_{\n}(t + \Delta t) = v_\n (t) + a_{n,\free} (t) + a_{n,\inter} (t),
\label{soucetzrych}
\end{equation}
kde $v_\n (t)$ znaèí rychlost vozidla v~èase $t$ a $\Delta t$ je simulaèní krok. Aktuální zrychlení vozidla se tedy vypoèítá jako souèet zrychlení pøi volném proudu $a_{n,\free}$ a zrychlení, ve kterém je zahrnut i vozidlo jedoucí pøed ním $a_{n,\inter}$. Zde je vidìt urèitá paralela s~Gippsovım modelem (kapitola \ref{sec:Gipps}), kde se ovšem vybírá pouze jedna z~tìchto dvou hodnot. Navíc i~rovnice se od IDM odlišují. Pro volnı proud je tedy zrychlení $a_{n,\inter} {}={} 0$.

Zrychlení pøi volném proudu je definováno vztahem
\begin{equation}
a_{n,\free} (t){}={} a\left[1-\left(\frac{v_n (t)}{v_{n,\free}}\right)^\delta\right],
\label{zrychvolproud}
\end{equation}
kde $a$ je maximální zrychlení, $\delta$ je exponent zrychlení, kterı napomahá zpøesnìní vıpoètu zrychlení $a_{n,\free}$, $v_n$ je aktuální rychlost vozidla a $v_{n,\free}$ je rychlost, které chce vozidlo dosáhnout.

Pokud v~rovnici \eqref{zrychvolproud} bude zlomek $v_n (t)/ v_{n,\free}$ roven jedné, vozidlo se ji dostalo na svou preferovanou rychlost $v_{n,\free}$ a celkové zrychlení $a_{n,\free} (t)$ bude rovno nule. Naopak pokud bude $v_n (t)$ rovno nule, znamená to, e $a_{n,\free} (t)$ bude pøímo rovno $a$, a vozidlo pojede svım maximálním zrychlením. Pokud $v_n (t)$ bude menší ne $v_{n,\free}$, pak platí, e èím vyšší hodnotu bude mít nastavenou parametr $\delta$, tím se dosáhne vyšší hodnota  $a_{n,\free} (t)$. Pokud $v_n (t)$ bude vìtší ne $v_{n,\free}$, bude platit pravı opak.

Podle rovnice \eqref{zrychvolproud} by bylo moné poèítat celkové zrychlení za pøedpokladu, kdyby vozidlo jelo na naprosto prázdné komunikaci. Tomu ovšem tak bıt nemusí, proto se do rovnice \eqref{soucetzrych} pøidává interakèní èlen, kterı pøímo závisí na parametrech vozidla jedoucí pøed naším úèastníkem. Tento èlen je roven
\begin{equation}
a_{n,\inter} (t) = - a \left(\frac{s_n^*(t)}{s_n(t)}\right)^2,
\label{intclen}
\end{equation}
kde $a$ je maximální zrychlení, $s_n(t) = x_{n-1}(t) - x_n(t)$ je rozdíl poloh vozidel a $s_n^*(t)$
\begin{equation}
s_n^*(t) = s_\text{0} + v_n(t) \tau + \frac{v_n(t)(v_n(t) - v_{n-1}(t))}{2\sqrt{ab}}
\label{snhvez}
\end{equation}
je preferovanı odstup. Hodnota $s_\text{0}$ se vypoète jako souèet minimální bezpeèné vzdálenosti mezi vozidly a délkou následujícího vozidla, $\tau$ je bezpeènostní èasovı odstup mezi vozidly a $b$ je konstanta brzdìní. Situace je schématicky znázornìna na obrázku \ref{promen}, kde jsme pro pøehlednost neuvedli závislost jednotlivıch promìnnıch na èase.

Èlen v èitaleli zlomku rovnice \eqref{snhvez} je kvadratickı v~promìnné $v_n(t)$ a obsahuje souèin $v_n(t) v_{n-1}(t)$. Tyto nelineární èleny popisují interakci, v~tomto pøípadì dvou vozidel. Pokud tedy bude vzdálenost $s_n(t)$ mezi vozidly vysoká, potom zlomek $s_n^*(t)/s_n(t)$ bude mít velmi malou hodnotu a interakèní èlen $a_{n,\inter}(t)$ lze zanedbat, take vozidlo se pohybuje jako ve volném proudu.
\begin{figure}%
\centering
\includegraphics[width=0.6\textwidth]{idm.pdf}%
\caption[Promìnné jednotlivıch vozidel - Intelligent Driver Model]{Promìnné jednotlivıch vozidel, zdroj: \cite{Vanis}}%
\label{promen}%
\end{figure}


Pokud rychlost vozidla $v_n (t)$ bude vyšší ne rychlost vozidla $v_{n-1} (t)$, pak interakèní èlen $s_n^* (t)$ bude kladnı a poadovanı odstup se zvìtší, take zrychlení vozidla $v_{\n}(t + \Delta t)$ se musí sníit.

Dosazením do rovnice \eqref{soucetzrych} za $a_{n,\inter} (t)$ z~rovnice \eqref{intclen} a $a_{n,\free} (t)$ z~rovnice \eqref{zrychvolproud} dostáváme \textbf{koneènı vztah pro zrychlení vozidla}:
\begin{equation}
v_{\n}(t + \Delta t) = v_\n (t) + a\left[1-\left(\frac{v_n (t)}{v_{n\free}}\right)^\delta\right] - a \left(\frac{s_\text{0} + v_n (t) \tau + \displaystyle\frac{v_n(t)(v_n(t) - v_{n-1}(t))}{2\sqrt{ab}}}{s_n(t)}\right)^2.
\label{eq:IDMcompl}
\end{equation}

\subsection{Parametry IDM}
\label{subsec:parameterAddKrauss}
Všechny promìnné a parametry IDM potom jsou:
\begin{itemize}
	\item $s_n$ -- aktuální odstup mezi vozidly,
	\item $\tau$ -- bezpeènostní èasovı odstup mezi vozidly,
	\item $v_{\n}$ -- rychlost aktuálního vozidla,
	\item $v_{\nm1}$ -- rychlost $n-1$ vozidla,
	\item $a$ -- maximální hodnota zrychlení, kterım je øidiè ochoten zrychlovat,
	\item $b$ -- maximální decelerace,
	\item $s_0$ -- bezpeènostní mezera mezi vozidly,
	\item $v_{n\free}$ -- preferovaná rychlost vozidla.
\end{itemize}


\section{Wiedemannùv model}
\label{sec:Wiedemann}

V~programu SUMO je také pøipraven Wiedemannùv model, jeho první verze vznikla ji v~roce 1974 jako disertaèní práce tehdejšího studenta R. Wiedemanna. Tento model byl posléze nìkolikrát vylepšován, v~roce 1992 o~tomto modelu vyšel aktualizovanı èlánek. Wiedemannova disertaèní práce je bohuel psána nìmecky a navíc je v~podstatì nedostupná, stejnì jako zmiòovanı èlánek. V~této sekci budeme hlavnì vycházet z~èlánku \cite{Higgs}. V~nìm najdeme pomìrnì pøesnı popis Wiedemannova modelu\footnote{Tento èlánek se pøímo odkazuje na èlánek z~roku 1992.}.

Tento model je odlišnı oproti pøedcházejícím tím, e pracuje v~tzv. reimech. Nejprve je nutné zjistit, v~jakém reimu se vozidlo vlastnì nachází a podle toho se urèuje vıpoèet akcelerace èi decelarace, která je pro kadı reim jiná. 

Klíèové pro pochopení Wiedemannova modelu je obrázek \ref{wiedemann}. Osa $x$ zobrazuje rozdíl rychlostí vozidel $\Delta v$ (aktuálního vozidla a vozidla jedoucího pøed ním) a na ose $y$ se nachází vzdálenost mezi tìmito vozidly $\Delta x$. Znamená to, e pokud rozdíl rychlostí a zároveò rozdíl poloh vozidel dosahuje urèitıch hodnot, lze tyto hodnoty pøiøadit jednomu konkrétnímu reimu, podle kterého je vozidlo dále zpracováváno. K~tomu, abychom mohli urèit pøíslušnı reim vozidla, musíme nejprve urèit prahové hodnoty køivek AX, ABX, SDX, CLDV, OPDV a SDV, znázornìnıch na obrázku \ref{wiedemann}.

Preferovanı odstup mezi stacionárními\footnote{nezávislé na èase} vozidly znaèíme AX. Je definován vztahem
\begin{equation}
\AX = L_{n-1} + \AXadd + \RNDI_n \cdot \AXmult,
\label{eq:AX}
\end{equation}
kde $\AXadd$ a $\AXmult$ jsou parametry modelu, $\RNDI_n$ znaèí parametr závislı na øidièi generovanı z~normálního rozdìlení a $L_{n-1}$ je délka èelního vozidla seètená s~preferovanou vzdáleností mezi vozidly.

\begin{figure}[h]%
\centering
\includegraphics[width=1\textwidth]{images/wiedemann.pdf}%
\caption[Reimy Wiedemannova modelu]{Reimy Wiedemannova modelu, zdroj: \cite{Higgs}}%
\label{wiedemann}%
\end{figure}

ABX je preferovaná maximální vzdálenost mezi vozidly pøi malıch rozdílech rychlosti. Ten se vypoèítá následovnì:
\begin{equation}
\ABX = \AX + \BX,
\label{eq:ABX}
\end{equation}
kde 
\begin{equation}
\BX = (\BXadd + \BXmult \cdot \RNDI_n)\cdot \sqrt{v (t)},
\label{eq:BX}
\end{equation}
kde $\BXadd$ a $\BXmult$ jsou opìt parametry modelu. Rychlost $v (t)$ urèujeme na základì rychlostí aktuálního a následujícího vozidla,
\begin{equation}
 v (t)= \left\{
  \begin{array}{l l}
    v_{\nm1} (t) & \quad \text{pro} \quad v_n (t) > v_{\nm1} (t),\\
    v_n (t) & \quad \text{pro} \quad v_n (t) \leq v_{\nm1} (t).
\end{array} \right.
\label{eq:v}
\end{equation}

Maximální vzdálenost pøi které bere vozidlo na zøetel vozidlo pøed sebou se znaèí SDX. SDX se pohybuje mezi 1{,}5 a 2{,}5násoobkem hodnoty ABX a je definována následovnì:
\begin{equation}
\SDX = \AX + \EX \cdot \BX,
\label{eq:sdx}
\end{equation}
kde EX stejnì jako u~ostatní èlenù je roven
\begin{equation}
\EX = \EXadd + \EXmult \cdot (\NRND - \RNDII_n).
\label{eq:ex}
\end{equation}

Parametry $\EXadd$ a $\EXmult$ se pouívají pro zpøesnìní vıpoètù, hodnota $\NRND$ je generována z~normálního rozdìlení a $\RNDII_n$ znaèí parametr závislı na øidièi generovanı také z~normálního rozdìlení.

Další dùleitou køivku urèující práh, kdy øidiè zjistí, e se pøibliuje pomalejšímu vozidlu pøed sebou, znaèíme SDV. Vypoèítá se vztahem:
\begin{equation}
SDV = \left(\frac{\Delta x - L_{\nm1} - AX}{CX}\right)^2,
\label{eq:SDV}
\end{equation}
kde CX zavedeme jako
\begin{equation}
\CX = \CXconst \cdot (\CXadd + \CXmult \cdot (\RNDII_n + \RNDII_n)),
\label{eq:CX}
\end{equation}
Parametry $\CXconst$, $\CXadd$ a $\CXmult$ jsou zde opìt pro zpøesnìní vıpoètù pøi urèování reimu.

Pokud se jedná o~klesající rozdíl rychlostí CLDV, v~\cite{Higgs} je uvedeno, e v~èlánku z~roku 1992 od Wiedemanna a Reitera je køivka CLDV totoná s køivkou SDV. Jak ji naznaèil obrázek \ref{wiedemann}, v našem pøípadì uvaujeme ve shodì s \cite{Higgs} rùzné prùbìhy.

Pøi zvyšujícím se rozdílu rychlostí, OPDV, øidiè zjišuje, e jede rychlostí niší ne vozidlo pøed ním. Práh OPDV se vypoèítá jako souèin SDV a parametrù modelu $\OPDVadd$, $\OPDVmult$ a $\NRND$, co je náhodné èíslo z~normálního rozdìlení,
\begin{equation}
\begin{split}
\OPDV = \CLDV \cdot ( -\OPDVadd& - \OPDVmult \cdot \NRND) =\\
&\SDV \cdot ( -\OPDVadd - \OPDVmult \cdot \NRND).
\end{split}
\label{eq:OPDV}
\end{equation}

Na základì tìchto práhù stanovujeme pøíslušnı reim Wiedemannova modelu. Tyto reimy jsou takté zobrazeny na obrázku \ref{wiedemann}. 

\paragraph{Reim následování:}
Hodnota zrychlení vozidla je vdy poèítána pro kadou iteraci znovu od nuly. Dùvodem je nepøesné zacházení s~plynovım pedálem ve vozidle. Pokud vozidlo pøekoná práh $\SDV$ èi $\ABX$, jeho hodnota akcelerace bude rovna $- b_{null}$. Naopak pøi dosáhnutí prahù $\OPDV$ èi $\SDX$ bereme kladnou hodnotu $b_{null}$. Akcelerace èi decelerace je definována jako
\begin{equation}
b_{null} = \BNULLmult \cdot (\RNDIV_n + \NRND),
\label{eq:bnull}
\end{equation}
kde $\BNULLmult$ je parametr modelu, hodnota $\NRND$ je generována z~normálního rozdìlení a $\RNDIV_n$ znaèí parametr závislı na øidièi; je generován také z~normálního rozdìlení.

\paragraph{Reim plné rychlosti:}
Vozidlo je umístìno nad všemi prahy v~obrázku \ref{wiedemann} a jede nezávisle na okolní dopravì. Vozidlo jede s~maximálním zrychlením tak, aby dosáhlo své preferované rychlosti. Nepøesné zacházení s~plynem ve vozidle je modelováno pøiøazením akcelerace $b_{null}$ èi $-b_{null}$. Maximální zrychlení je definováno jako

\begin{equation}
b_{\max} = \BMAXmult \cdot (v_{\max} - v\cdot \FaktorV),
\label{eq:bmax}
\end{equation}
kde $\FaktorV$ zavedeme jako
\begin{equation}
\FaktorV = \frac{v_{\max}}{v_{des} + \FAKTORVmult \cdot (v_{\max} - v_{des})},
\label{eq:faktorV}
\end{equation}
kde $v_{\max}$ je maximální rychlost vozidla a $\FAKTORVmult$ parametr modelu.

\paragraph{Reim pøiblíení:}
Pokud pøesáhne vozidlo práh $\SDV$, øidiè zjišuje, e se pøibliuje pomalejšímu vozidlu. Øidiè tedy zaène zpomalovat, aby zabránil kolizi. Decelerace se vypoèítá vztahem
\begin{equation}
b_n = \frac{1}{2} \frac{(\Delta v)^2}{\ABX - (\Delta x - L_{\nm1})}+ b_{\nm1},
\label{eq:bn}
\end{equation}
kde $b_{\nm1}$ je decelerace následujícího vozidla.

\paragraph{Nouzovı reim:}
Jestlie vzdálenost èela aktuálního vozidla s~nárazníkem vozidla pøed aktuálním je menší ne $\ABX$, decelerace se vypoèítá následovnì
\begin{equation}
b_n = \frac{1}{2} \frac{(\Delta v)^2}{\AX - (\Delta x - L_{\nm1})}+ b_{\nm1} + b_{\min} \frac{\ABX - (\Delta x - L_{\nm1})}{\BX},
\label{eq:bnemer}
\end{equation} 
kde $b_{\min}$ je maximální decelarace vozidla a zavedeme ji jako
\begin{equation}
b_{\min} = -\BMINadd - \BMINmult \cdot \RNDIII_n + \BMINmult \cdot v_n (t),
\label{eq:bmin}
\end{equation} 
kde $\BMINadd$ a $\BMINmult$ jsou parametry modelu a $\RNDIII_n$ znaèí parametr závislı na øidièi generovanı z~normálního rozdìlení. 


\section{Shrnutí}

Èasovì spojité mikroskopické modely jsou v~zásadì definovány funkcí zrychlení. V~nejstarších modelech, tj. modelech General Motors, mùe bıt zrychlení $a (t + \Delta t)$ vozidla $n$ zapsáno jako
\begin{equation}
a (t + \Delta t) = \frac{-\lambda (v_n (t))^m \Delta v_n (t)}{s_n (t)^l},
\label{eq:earliermodels}
\end{equation}
kde $\lambda$, $l$ a $m$ jsou parametry modelu, $s$ je odstup mezi vozidly a $\Delta v_\n (t)$ rozdíl rychlostí aktuálního vozidla a vozidla jedoucího pøed aktuálním.

Kromì toho mùe zrychlení mùe také záviset na vlastní rychlosti vozidla $v_n (t)$ a klesá se vzdáleností $s_n (t)$ k~vozidlu pøed ním,
\begin{equation}
s_{n} (t) = x_{\nm1} (t) - x_{n} (t) - l_{n},
\label{eq:distancebetween}
\end{equation}
kde $l_{\n}$ je délka vozidla $\n$.

V~závislosti na rovnici \eqref{eq:earliermodels}, kdy zrychlení závisí na vedoucím vozidle, tyto modely není moné pouít pøi velmi nízkıch hustotách provozu. Pokud není urèeno vedoucí vozidlo ($s_{\n} \rightarrow \infty$), zrychlení buïto není moné stanovit (pro hodnotu $l = 0$) nebo je rovné nule ($l > 0$) bez ohledu na rychlost vozidla. Dá se pøedpokládat, e v~tuto chvíli se vozidla budou snait dosáhnout své preferované rychlosti. Chování vozidel v~hustém provozu je ovšem ponìkud nerealistické. Pøedevším odstup mezi vozidly $s$ tıkající se vedoucího vozidla nemusí nutnì smìøovat k~rovnovánému stavu. Ani malé mezery nepøimìjí vozidlo k~brdìní, pokud je rozdíl rychlostí $\Delta v_\n$ roven nule.

Tyto problémy byly vyøešeny v~Newellovì modelu (viz podkapitola \ref{sec:Newell}), kde je z~rovnice \eqref{eq:newellcompl} vidìt, e zrychlení není závislé pouze na rozdílù rychlostí. Newellùv model je nekolizní, ale okamitá závislost na rychlosti na hustotì provozu vede k~velmi vysokım hodnotám zrychlení \cite{Treiber}.
 
Další model, kterı obsahuje realistické brzdné reakce øidièù, je Gippsùv model, podkapitola \ref{sec:Gipps}, a Kraussùv model, podkapitola \ref{sec:Krauss}. Navzdory své jednoduchosti, tyto modely realisticky popisují chování øidièe a jsou nekolizní. Bohuel u tìchto modelù není moné nikdy dosáhnout stacionárního stavu, a to z dùvodu vybírání minima z nìkolika hodnot (jedna hodnota by k nìmu smìøovala, ale na základì volby ze dvou (Gipps) èi tøí (Krauss) moností se vybere jiná). V~tìchto pøípadech potom není moné simulovat nestabilní stavy dopravy.

Tento problém se snaí odstanit IDM model, podkapitola \ref{sec:IDM}, kterı rychlost urèuje na základì zrychlení volného proudu a interakèního zrychlení, kde velikost interakèního zrychlení stoupá s klesající mezerou mezi aktuálním vozidlem a vozidlem jedoucím pøed aktuálním.

Kromì Newellova modelu a dalších modelù pro základní vızkum existují také vysoce komplexní modely jako Wiedemannùv, podkapitola \ref{sec:Wiedemann}. Bohuel tyto modely mají mnoho parametrù.
