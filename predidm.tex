

\chapter{Modely pøedcházející IDM}
\label{chap:predIDM}

\begin{comment}
Jednoduše øeèeno „Car Following“ modely vycházejí z pøedpokladu, když $n$-té vozidlo následuje ($n-1$)-té vozidlo na homogenní (stejnorodé) dálnici, trajektorie n-tého vozidla bude v podstatì stejná jako ($n-1$) vozidla kromì posunù v èase a místì. (Vozidlo bude ve stejném místì jako pøedcházející v jiný èas a ve stejný èas bude na jiném místì.) Všechna ostatní vymyšlená pravidla (modely) v sobì toto jednoduché a pomìrnì pøesné pravidlo obsahují. Newellùv model je v podstatì speciálním pøípadem ostatních modelù s ménì parametry a jinou logikou. Posloužil také jako základ pro pozdìjší Intelligent Driver Model.
\end{comment}

Jednoduše øeèeno \uv{Car Following} modely vycházejí z pøedpokladu, že pokud n-té vozidlo následuje $n-1$ vozidlo na homogenní dálnici, trajektorie n-tého vozidla bude stejná jako vozidla pøed ním ($n-1$) až na posuny v èase a místì. (Vozidlo bude ve stejném místì jako pøedcházející v jiný èas a ve stejný èas bude na jiném místì.) Všechny další dispozice jednotlivých modelù v sobì tento pøedpoklad obsahují.

\section{Newellùv model}
\label{sec:Newell}

V teorii dopravního proudu je Newellùv model jeden z modelù, který popisuje chování øidièe dle vozidla pøed ním. Øidiè se snaží držet za vozidlem jedoucím pøed ním v konstantní  vzdálenosti. Tento model vznikl v roce 1961 a postupnì se vyvíjel. Vychází z nìho pozdìji Intelligent Driver Model (IDM) a z tohoto dùvodu je zde zmínìn.

V èlánku \cite{Newell} je pøesnì popsán nejen model, ale i jeho verifikace a porovnání s ostatními modely. Pro nás je dùležitý popis modelu.

\subsection{Popis modelu}
Jestliže $n$-té vozidlo jede za $n-1$ vozidlem (které jede za $n-2$ vozidlem atd.), cíl každého Car following modelu je zjistit závislost trajektorie $n$-tého vozidla  $x_{\n}(t)$, jeho pozici v èase $t$ na $n-1$ vozidle, viz. obrázek \ref{newell}. (To také znamená, že není žádná náhodná spojitost mezi tìmito vozidly.)
Jestliže se $n-1$ vozidlo pohybuje konstantní rychlostí $v$,
\[
x_{{\nm1}} {}={} x_{\n} + vt,
\]
$n$-té vozidlo také pojede prùmìrnou rychlostí $v$. Pokud by $n$-té vozidlo zrychlovalo, tak by došlo ke kolizi s $n-1$ vozidlem a naopak pokud by zpomalovalo, tak by se $n$-té vozidlo neustále vzdalovalo. Totéž platí pro všechna vozidla jedoucí za $n$-tým. Tento model se nezabývá zjištìním hodnoty rychlosti $v$, pøedpokládá se, že je urèena buïto na základì omezení rychlosti èi možnostech vozidla.

\begin{figure}[ht]%
\centering
\includegraphics[]{images/newell.pdf}%
\caption{Trajektorie vozidel s konstantní rychlostí, zdroj: \cite{Newell}}%
\label{newell}%
\end{figure}

Vzdálenost $s_\n = x_{\nm1} (t) - x_\n (t)$ mezi vozidly $n$ a $n-1$ se mùže mìnit v èase. Pokud je dálnice homogenní, tato vzdálenost zùstane konstantní okolo hodnoty $s_\n$. Tato hodnota se mìní na základì typu vozidla a také závisí na rychlosti $v$.

Pøedpokládejme, že existuje nìjaký empirický vztah mezi rychlostí $v$ a vzdáleností mezi vozidly $s_\n$. Pokud rychlost $v$ roste, je logické, že øidièi chtìjí dosáhnout vìtšího rozestupu mezi vozidly. Tato  závislost mezi $v$ a $s_\n$ je znázornìna na obrázku \ref{vztahmezivas}. Každý øidiè má svoji preferovanou rychlost $\text{V}_\n$. Jestliže tato rychlost je u $n-1$ vozidla vyšší než u $n$-tého $v>\text{V}_\n$, znamená to, že $n$-té vozidlo pojede svoji preferovanou rychlostí (na obrázku \ref{vztahmezivas} znázornìna èárkovanou èárou) a $n-1$ vozidlo mu ujede.
Hodnota rychlosti $v$ nemùže být záporná a vzdálenost mezi vozidly pøi nulové rychlosti by mìla být níže než polopøímka lineární závislosti, viz èerná teèka na obrázku \ref{vztahmezivas} pøi rychlosti $v=0$.
\begin{figure}[ht]%
\centering
\includegraphics[]{images/vztahmeziSaV.pdf}%
\caption{Vztah mezi rychlostí $v$ a vzdáleností mezi vozidly $s_\n$, zdroj: \cite{Newell}}%
\label{vztahmezivas}%
\end{figure}

Nyní pøedpokládejme, že $n-1$ se vozidlo nìjakou dobu $t$ pohybuje konstantní rychlostí $v$\footnote{hodnota rychlosti osciluje okolo hodnoty $v$} a potom náhle zmìní rychlost na hodnotu $v'$. Trajektorie vozidel $n$ a $n-1$ mohou poté vypadat jako na obrázku \ref{linearaprox}. Z obrázku lze také vypozorovat jak èasovou $\tau_\n$, tak prostorovou $d_\n$ mezeru mezi vozidly $n$ a $n-1$. Z èárkovaného obdelníku poté dostáváme vztah vzdálenost mezi vozidly pøed zmìnou rychlosti $s_\n$ a po zmìnì rychlosti $s'_\n$,
\[
s_\n{}={}d_\n + v\tau_\n,\qquad s'_\n{}={}d_\n + v'\tau_\n. 
\]

Z toho vyplývá, že pokud leží $v$ a $v'$ na polopøímce z obrázku \ref{vztahmezivas}, sklon této pøímky je právì $\tau_\n$ a hodnota $s_n$ pøi rychlosti $v = 0$ je $d_\n$.

Ze vztahu mezi $v$ a $s_\n$, jak je zobrazeno na obrázku \ref{vztahmezivas}, plyne nezávislost mezer $d_\n$ a $\tau_\n$ na rychlostech $v$, resp. $v'$. Pokud se tedy zmìní rychlost z hodnoty $v'$ na $v''$, $d_\n$ a $\tau_\n$ zùstanou pøi této zmìnì rychlosti stejné. Lineární trajektorie vozidla $x_n(t)$ potom bude jednoduše posun v èase $\tau_\n$ a místì $d_\n$,
\begin{equation}
x_\n(t+\tau_\n) {}={} x_{\nm1}(t) - d_\n.
\label{eq:newelxn}
\end{equation}

U Newellova modelu platí, že n-té vozidlo bude (pøibližnì) kopírovat trajektorii n-1 vozidla dle vztahu \eqref{eq:newelxn} pøi vhodných hodnotách $d_\n$ a $\tau_\n$. Tím, jak se pøesnì dokáže n-té vozidlo dodržovat vztah \eqref{eq:newelxn}, se Newellùv model nezabývá, pouze pøedpokládá, že øidiè je schopen se tímto vztahem øídit. To není tak tìžké, protože pokud se zmìní rychlost vozidla $n-1$, n-tý øidiè nemusí zareagovat okamžitì, ale mùže poèkat dokud se mezera $s_\n$ nezvýší (neklesne) na hodnotu, která odpovídá nové rychlosti vozidla n-1 (viz obrázek \ref{vztahmezivas}).
\begin{figure}[ht]%
\centering
\includegraphics[]{images/linearaprox.pdf}%
\caption{Lineární aproximace pøi zmìnì rychlosti vozidel, zdroj: \cite{Newell}}%
\label{linearaprox}%
\end{figure}

Pøi pozorování se došlo k závìru, že každý øidiè nezkoumá každého jiného øidièe na komunikaci, ale pouze jen vhodnou \uv{makroskopickou} èást. Hodnoty $\tau_\n$ a $d_\n$ jsou pøirozené, to vychází ze vztahu \eqref{eq:newelxn}, kde postupným iterováním dostaneme

\begin{equation}
x_\n(t+\tau_\n + \tau_{\nm1} + \cdots + \tau_1) {}={} x_0(t) - d_\n - d_{\nm1} - \cdots - d_1.
\label{eq:newelxn0}
\end{equation}

Hodnoty $\tau_\n$ a $d_\n$ se znaènì liší mezi jednotlivými vozidly v závislosti na typu øidièe. První skupina øidièù radìji jede blíže vozidlu pøed sebou ($n-1$) až na minimální bezpeènou vzdálenost, zatímco druhá skupina naopak preferuje delší vzdálenost pro klidnou reakci na nenadálou událost. Je rozumné, aby se hodnoty $\tau_n$ a $d_\n$ lišily, a to tak, že každému jednotlivému vozidlu budou hodnoty vygenerovány z nìjakého pravdìpodobnostního rozdìlení, jehož variaèní koeficient se bude blížit jedné. Pøi generování rychlostí vozidel by naopak mìl být variaèní koeficient zanedbatelný.

Položíme-li

\begin{equation}
\overline{\tau}{}={}\frac{1}{n}\sum_{k=1}^n \tau_k,\qquad \overline{d}{}={}\frac{1}{n}\sum_{k=1}^n d_k,
\label{eq:averagedtau}
\end{equation}

kde $\overline{\tau}$ a $\overline{d}$ jsou prùmìrné posuny v èase resp. místì, potom prùmìrnou vlnovou rychlost spoèteme jako podíl $\overline{d}/\overline{\tau}$.

Tento model se dá ovšem popsat nejen mikroskopicky (rychlost, mezera mezi vozidly), ale i makroskopicky (hustota $k$, intenzita $q$). Stacionární stav nastane ve chvíli, kdy se všechna vozidla budou pohybovat konstantní rychlostí s rozdílnými posuny (èasovými i prostorovými). 

Jestliže
\[
s_\n{}={}d_\n + v\tau_\n,
\]
a rychlost vozidel je konstantní, tak platí
\[
\overline{s}{}={}\overline{d} + v\overline{\tau}.
\]

Hustotu $k$ lze potom vypoèítat jako pøevrácenou hodnotu prùmìrné mezery mezi vozidly $k{}={}1/\overline{s}$ a rychlost jako podíl intenzity a hustoty $v = q/k$. Tudíž platí
\begin{equation}
q = \frac{1}{\overline{\tau}} - \frac{\overline{d}}{\overline{\tau}}k,
\label{eq:qk}
\end{equation}

za pøedpokladu, že rychlost $v$ je menší než preferovaná rychlost jakéhokoliv vozidla $V_k$.

Rovnice \eqref{eq:qk} propojuje Newellùv model s klasickými makroskopickými modely. Problém nastává ve chvíli, kdy prùmìrná rychlost $v$ je vysšší, než nìkterá s preferovaných rychlostí jednotlivých vozidel. Vozidla se v tomto modelu nemohou pøedjíždìt a proto vznikne kongesce za vozidlem s malou preferovanou rychlostí. V následujících øádcích pøedpokládáme, že aktuální rychlost vozidla bude menší než preferovaná rychlost $V_\n$.

Uvažujme, že se vozidlo $n$ pohybuje pøesnì podle rovnice \eqref{eq:newelxn} a vozidlo za ním ($n-1$) jede plynule za ním.

Rovnici \eqref{eq:newelxn} mùžeme pøepsat do tvaru
\begin{equation}
x_\n(t+\tau_\n) {}={} x_\n(t) + \tau_\n v_\n(t+T_\n).
\label{eq:xntaun}
\end{equation}
Rovnice \eqref{eq:xntaun} lze pro rovnomìrný pohyb zjednodušit na tvar
\[
x_\n(t+\tau_\n) {}={} x_\n(t) + \tau_\n v_\n(t).
\]
Tvar rovnice \eqref{eq:xntaun} plyne z matematické analýzy\footnote{vìta o støední hodnotì}, pøièemž hodnota $T_\n$ se nachází nìkde mezi nulou a $\tau_\n$. Pokud je funkce hladká bude pøibližnì
\begin{equation}
T_\n = \frac{\tau_\n}{2}.
\label{eq:Tn}
\end{equation}
Rovnici \eqref{eq:xntaun} lze pøepsat na pøibližný tvar
\begin{equation}
x_\n(t+\tau_\n) {}={} x_\n(t) + \tau_\n v_\n(t) + \tau_\n T_\n a_\n(t),
\label{eq:xntaunx}
\end{equation}
který uvažuje zrychlení vozidla $a_\n$\footnote{Pøedpokládejme vozidlo v klidu, které se rozjíždí. Na zaèátku zvolíme $\tau_\n = 5s, t = 0s, T_\n= \tau_\n/2 = 2,5s$, potom platí
\[
x_\n(5) {}={} x_\n(0) + 5 v_\n(0 +2,5).
\]
Pro výpoèet dráhy bereme hodnotu rychlosti v èase 2,5s. Nemùžeme vzít hodnotu v nule, vozidlo by v tomto pøípadì stálo na místì. Pøibližná hodnota bude tedy opravdu v polovinì hodnoty $\tau_\n$. 
}.
Kombinací rovnic \eqref{eq:xntaunx} a \eqref{eq:newelxn} dostáváme vztah pro rychlost
\begin{equation}
v_\n(t+\tau_\n) {}={} \frac{1}{\tau_\n}\left[x_{\nm1}(t)-x_\n(t)\right] - \frac{d_\n}{\tau_\n}.
\label{eq:xntaunv}
\end{equation}
Po zderivování rovnice \eqref{eq:xntaunv} dostáváme vztah pro zrychlení vozidla
\begin{equation}
a_\n(t+\tau_\n) {}={} \frac{1}{\tau_\n}\left[v_{\nm1}(t)-v_\n(t)\right].
\label{eq:xntauna}
\end{equation}
Z rovnic \eqref{eq:xntaunv} a \eqref{eq:xntauna} je vidìt zøejmá závislost na vozidle, které jede pøed aktuálním,  èlenem $v_{\nm1}(t)$, resp. $x_{\nm1}(t)$. Øidiè volí svoji rychlost na základì odstupu od pøedchozího vozidla, resp. zrychlení na základì rychlostí. \textbf{Koneèný vztah pro Newellùv model je tedy}
\begin{equation}
a_\n(t) {}={} \frac{\frac{1}{\tau_\n}\left[v_{\nm1}(t)-v_\n(t)\right] - \frac{d_\n}{\tau_\n} - v_\n(t)}{T_n}.
\label{eq:newellcompl}
\end{equation}





\section{Gippsùv model}
\label{sec:Gipps}

Další model, kterým se zde budeme zabývat, se jmenuje Gippsùv. Tento model byl poprvé popsán v roce 1981 a odvolává se i na zmínìný Newellùv model. I v dnešní dobì se tento model využívá pro simulaci dopravyy. Hlavním zdrojem pro tuto podkapitolu je èlánek P.G. Gippse\cite{Gipps}. Vìtšina modelù, které vznikly pøed Gippsovým, jsou rùzné variace na rovnici
\begin{equation}
a_\n(t+T_n) {}={} l_n\frac{[v_{\nm1}(t) - v_\n(t)]^k}{[x_{\nm1}(t) - x_\n(t)]^m},
\label{eq:othermodels}
\end{equation}
kde jednotlivé promìnné mají stejný význam jako pøi popisu Newellova modelu \ref{sec:Newell}. Promìnné $l_n$, $k$ a $m$ jsou parametry, které je nutno empiricky odhadnout. Tyto modely se nazývají Modely General Motors a jsou blíže rozebrány v \cite{Vanis}.

Aèkoliv podávají tyto modely dobré výsledky v mnoha situacích, je žádoucí, aby bìhem pøepoètù poloh, rychlostí a zrychlení nìjakým zpùsobem byl zahrnut reakèní èas øidièe $T_\n$. To si vyžaduje znaèné množství historických dat, pokud model bude použit v simulaèním programu. Navíc, parametry $l_n$, $k$ a $m$ nemají pøímou souvislost s vlastnostmi vozidla èi øidièe.

Gipps se proto rozhodl, že vytvoøí model, který bude splòovat následujicí podmínky:

\begin{itemize}
	\item model by mìl napodobovat chování opravdového provozu,
	\item parametry modelu by mìly odpovídat vlastnostem øidièe a vozidla, které jsou jasné; to znamená, že pro nastavení parametrù není potøeba model kalibrovat,
	\item model by se mìl chovat správnì i v pøípadì, že doba mezi pøepoèítáváním polohy a rychlosti je stejná, jako reakèní èas øidièe.
\end{itemize}

\subsection{Popis modelu}

Následující model je odvozen z omezení jak øidièe, tak i vozidla a pomocí tìchto omezení se dopoèítávají bezepeèná rychlost podle pøedcházejícího vozidla. Pøedpokládá se pøitom, že øidiè volí svoji rychlost tak, aby zajistil bezpeèné zastavení nebo aby dokázal náhle rychle zastavit pøi nenadálé události.

První podmínka, kterou aplikujeme na vozidlo $n$, souvisí s rychlostí vozidla. Ta nepøekroèí jeho preferovanou rychlost $V_\n$ a jeho zrychlení na volné komunikaci\footnote{tj. komunikace, na které se nevyskytuje žádné další vozidlo} se zvyšuje stejnì tak jako rychlost dokud se také zvyšuje kroutící moment motoru vozidla a poté zaène klesat na nulovou hodnotu a té nabude ve chvíli, kdy se vozidlo bude pohybovat svoji preferovanou rychlostí $V_n$

\begin{equation}
v_\n (t+\tau) {}={} v_\n (t) + 2,5a_\n \tau \left(\frac{1-v_\n (t)}{V_\n}\right)\sqrt{\left(0,025+\frac{v_\n (t)}{V_\n}\right)}.
\label{eq:inequalitygipps}
\end{equation}

\begin{comment}
 Tento výraz je zcela popisný, pøesná forma zvolena z nìkolika zároveò postaèujících popisù na základì jednoduše získaných výpoètù. 
\end{comment}
Koeficienty v nerovnici \ref{eq:inequalitygipps} byly stanoveny na základì z mìøení na hlavních dopravních komunikacích pøi prùmìrném provozu.  Využití nerovnice \ref{eq:inequalitygipps} pro tento model je považované za pøijatelné do chvíle, kdy se vozidlo pøiblíží vozidlu jedoucím pøed ním. Od té chvíle dùraz na tuto podmínku klesá, naopak nejvìtší dùležitost je ve chvíli, kdy vozidlo nemá pøed sebou žádné vozidlo èi vozidlo pøed ním se nachází velmi daleko.